---
banner: 模板/banner.jpg
banner_y: "87.5"
---
# 演算法筆記 第 5 講：大師定理

[[演算法筆記_總覽與考試重點]]

## 大師定理 (Master Theorem)

大師定理提供了一種解決特定形式遞迴關係式時間複雜度的「公式法」。這類遞迴關係式通常出現在分治演算法中。

### 定理描述

給定遞迴關係式： T(n)=aT(n/b)+f(n) 其中：

- n 是問題的規模。
    
- a≥1 是遞迴呼叫的子問題數量。
    
- b>1 是每個子問題規模相對於原問題的縮小因子 (即子問題的規模為 n/b)。
    
- f(n) 是分割問題和合併結果所需的成本，且 f(n) 是一個漸進正函數 (asymptotically positive function)。
    

則 T(n) 的時間複雜度可以根據 f(n) 與 nlogb​a 的比較分為以下三種情況：

1. **情況 1 (Case 1):** 如果 f(n)=O(nlogb​a−ϵ) 對於某個常數 ϵ>0 成立。 (直觀地說，f(n) 的成長速度多項式級慢於 nlogb​a。) 則 T(n)=Θ(nlogb​a)。
    
2. **情況 2 (Case 2):** 如果 f(n)=Θ(nlogb​a)。 (直觀地說，f(n) 的成長速度與 nlogb​a 相同。) 則 T(n)=Θ(nlogb​alogn)。
    
3. **情況 3 (Case 3):** 如果 f(n)=Ω(nlogb​a+ϵ) 對於某個常數 ϵ>0 成立。 (直觀地說，f(n) 的成長速度多項式級快於 nlogb​a。) 並且如果對於某個常數 c<1 和所有足夠大的 n，滿足 af(n/b)≤cf(n) (此為**規律性條件 Regularity Condition**)。 則 T(n)=Θ(f(n))。
    

### 簡單理解

大師定理的核心在於比較「分割/合併成本」f(n) 與「遞迴成本的臨界函數」nlogb​a 的成長速度。

- nlogb​a **代表的意義:** 可以想像成遞迴樹中葉節點的數量級。每個葉節點代表一個基本問題，其成本通常為 Θ(1)。如果所有成本都集中在葉節點，那麼總成本就是葉節點數量乘以 Θ(1)，即 Θ(nlogb​a)。
    
- **比較** f(n) **和** nlogb​a**:**
    
    - **情況 1 (**f(n) **遠小於** nlogb​a**):** 遞迴呼叫的成本佔主導地位。總成本由葉節點的成本決定，即 T(n)=Θ(nlogb​a)。
        
    - **情況 2 (**f(n) **與** nlogb​a **相當):** 分割/合併的成本與遞迴呼叫的成本在每一層都差不多。總成本是 nlogb​a 乘以遞迴樹的深度 (logn)，即 T(n)=Θ(nlogb​alogn)。
        
    - **情況 3 (**f(n) **遠大於** nlogb​a**):** 分割/合併的成本佔主導地位。總成本由根節點的 f(n) 決定，但需要滿足規律性條件以確保 f(n) 的成本不會在遞迴過程中被子問題的 f(n/b) 總和超過。若滿足，則 T(n)=Θ(f(n))。
        

### 規律性條件 (Regularity Condition) for Case 3

af(n/b)≤cf(n) for some constant c<1 and all sufficiently large n. 這個條件確保了 f(n) 的成本確實是支配性的。它意味著在遞迴樹的每一層，根節點的 f(n) 成本至少是其所有子節點 f(n/b) 成本總和 (a⋅f(n/b)) 的一個常數因子 (1/c) 倍大。如果這個條件不滿足，即使 f(n) 漸進大於 nlogb​a，大師定理的第三種情況也可能不適用。

### 範例應用

1. T(n)=9T(n/3)+n  
    
    - a=9,b=3,f(n)=n  
        
    - 計算 nlogb​a=nlog3​9=n2。
        
    - 比較 f(n)=n 與 n2。
        
    - 因為 n=O(n2−ϵ) (例如取 ϵ=1)，這符合**情況 1**。
        
    - 所以，T(n)=Θ(n2)。
        
2. T(n)=T(2n/3)+1 (這可以寫成 T(n)=1⋅T(n/(3/2))+1)
    
    - a=1,b=3/2,f(n)=1  
        
    - 計算 nlogb​a=nlog3/2​1=n0=1。
        
    - 比較 f(n)=1 與 n0=1。
        
    - 因為 1=Θ(n0)，這符合**情況 2**。
        
    - 所以，T(n)=Θ(n0logn)=Θ(logn)。
        
3. T(n)=3T(n/4)+nlogn  
    
    - a=3,b=4,f(n)=nlogn  
        
    - 計算 nlogb​a=nlog4​3≈n0.792。
        
    - 比較 f(n)=nlogn 與 n0.792。
        
    - nlogn 的成長速度快於 n0.792。我們可以說 nlogn=Ω(nlog4​3+ϵ)。例如，取 ϵ=0.2，則 nlog4​3+0.2≈n0.992，nlogn 仍然比它快。
        
    - 檢查規律性條件：af(n/b)≤cf(n) 3⋅(n/4)log(n/4)≤c⋅nlogn (3/4)n(logn−log4)≤cnlogn (3/4)nlogn−(3/4)nlog4≤cnlogn 對於足夠大的 n，(3/4)nlogn 是左邊的主導項。 我們需要 (3/4)nlogn≤cnlogn 且 c<1。 如果我們選擇 c=3/4，則條件變為 (3/4)n(logn−log4)≤(3/4)nlogn。 因為 log4>0，所以 (3/4)n(logn−log4)<(3/4)nlogn 成立。 所以，如果 c=3/4 (或略大於 3/4 但小於 1 的值，例如 c=0.8)，規律性條件滿足。
        
    - 這符合**情況 3**。
        
    - 所以，T(n)=Θ(f(n))=Θ(nlogn)。
        
4. T(n)=2T(n/2)+nlogn  
    
    - a=2,b=2,f(n)=nlogn  
        
    - 計算 nlogb​a=nlog2​2=n1=n。
        
    - 比較 f(n)=nlogn 與 n。
        
    - f(n)=nlogn 比 n 成長快，但不是多項式級的快。即 nlogn/n=logn，它不是 nϵ 的形式。
        
    - 這種情況下，大師定理不直接適用（屬於大師定理的 gap）。
        
    - (進階說明：這種情況通常使用 Akra-Bazzi 定理或遞迴樹方法解決，結果是 Θ(nlog2n)。)
        

### 大師定理的限制

大師定理非常有用，但它不能解決所有形式為 T(n)=aT(n/b)+f(n) 的遞迴關係。主要有以下幾種情況大師定理不適用：

1. f(n) 與 nlogb​a 的比較落在情況1和情況2之間，或者情況2和情況3之間。例如，f(n) 比 nlogb​a 快，但不是多項式級的快 (如 T(n)=2T(n/2)+nlogn，其中 nlogb​a=n，而 f(n)=nlogn。這裡 f(n)/nlogb​a=logn，它不是 nϵ 也不是 Θ(1))。
    
2. 對於情況3，f(n)=Ω(nlogb​a+ϵ) 成立，但規律性條件 af(n/b)≤cf(n) (for c<1) 不成立。
    
3. f(n) 不是漸進正函數。
    
4. a<1 或 b≤1。
    

在這些情況下，需要使用其他方法，如遞迴樹法、代換法或 Akra-Bazzi 定理。